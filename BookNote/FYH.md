# FYH

windows 内核 函数结构体

https://www.vergiliusproject.com/kernels/x64/Windows%2010%20%7C%202016



冯一华

![image-20210521194355429](assets/image-20210521194355429.png)

csgo 个人模式可以ce附加，多人游戏会崩



## Class 2 找矩阵

矩阵单浮点

变动的数值 > 旋转鼠标，开镜关镜

未变动的数值 > 不动鼠标移动键盘，不动鼠标不动键盘 



找绿色的数据，（绿色表示基址，重启游戏还是这些数据）

浏览内存区域，显示类型 单浮点。



model view 矩阵的**特征**：

- size为 `4x4`

- 不开镜 `abs(A[0][0])` < 1.

  第一次开镜  `abs(A[0][0])` > 1.

  第二次开镜  `abs(A[0][0])` 更大.

- 后两行的前三个一直是相等的

  `A[2][0] \ A[2][1] \ A[2][2]`

  `A[3][0] \ A[3][0] \ A[3][0]`

- 最后一列数值通常比较大
- 不只有一个，可能有完全相同的多个



![image-20210521201723411](assets/image-20210521201723411.png)

上边的 `AllocationBase = 385D000` 这个就是基址，还有模块信息

然后这个矩阵的地址 - 基址 = 偏移量，即 `3D305504 - 385D0000 = 4D35504`

model view 矩阵 	`client_panorama.dll + 4D35504`



---

## Class 3 找角度

**浮点型**，**往上减少，往下增加**

先找 Y， Y + 4 = X （D3D引擎和OpenGL引擎，都是这样的）



未知的初始值， 变大的数值，变小的数值



model angle 的特征：

- **D3D 游戏**鼠标准心 Y 范围为：-89 - 89
- **D3D 游戏**鼠标准心 X 范围为：0 - 360



---

## Class 4 找自己的位置

x y z

找**单浮点** z 比较简单

然后在附近找 x 和 y

`client_panorama.dll + D2FB84 [3454]`



---

## Class 5 找敌人位置

根据我们的值的接近的值 找敌人的值 我们从一定到（控制敌人移动/停止移动）

找出来的地址里存储了很多指针

CSGO 从人物初始地址开始  `+10 Byte`  为另一个人物

添加 bot 或者减少 bot 查看是不是指针变多了

**通常找到敌人的指针，跟敌人有关的数据基本都在指向的这个对象里了。**（比如阵营标识、血量、护甲值、**甚至**骨骼位置）



---

## Class 6 敌人骨骼位置

骨骼特征：

- 浮点数
- 与敌人位置一样是三维坐标，连在一起的
- 看人，骨骼就会变；不看人，骨骼不变。（呼吸）
- 注意！！！！！！！！！！ 不看人的时候，要先搜一次变动的数值，再搜不变的数值！！！





---

## Class 7 inline hook

内联钩子

把游戏里的一些函数换成我们的函数，从而实现我们的操作

用新的汇编指令替换原本的指令，跳转到我们写的代码里。执行完在继续执行原来的内容。



注入

![image-20210522030002889](assets/image-20210522030002889.png)































